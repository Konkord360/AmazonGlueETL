{
  "name" : "youtube-KR-daily",
  "description" : "",
  "role" : "arn:aws:iam::057994567553:role/glueRole",
  "executionProperty" : {
    "maxConcurrentRuns" : 1
  },
  "command" : {
    "name" : "glueetl",
    "scriptLocation" : "s3://aws-glue-assets-057994567553-eu-north-1/scripts/youtube-KR-daily.py",
    "pythonVersion" : "3"
  },
  "defaultArguments" : {
    "--enable-metrics" : "true",
    "--enable-spark-ui" : "true",
    "--extra-py-files" : "s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_common.py,s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_derived.py,s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_flatten.py",
    "--spark-event-logs-path" : "s3://aws-glue-assets-057994567553-eu-north-1/sparkHistoryLogs/",
    "--enable-job-insights" : "true",
    "--enable-glue-datacatalog" : "true",
    "--enable-continuous-cloudwatch-log" : "true",
    "--job-bookmark-option" : "job-bookmark-disable",
    "--job-language" : "python",
    "--TempDir" : "s3://aws-glue-assets-057994567553-eu-north-1/temporary/"
  },
  "maxRetries" : 0,
  "allocatedCapacity" : 10,
  "timeout" : 2880,
  "maxCapacity" : 10.0,
  "glueVersion" : "3.0",
  "numberOfWorkers" : 10,
  "workerType" : "G.1X",
  "codeGenConfigurationNodes" : "{\"node-1694124952351\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1694124951274\"],\"Name\":\"new likes to dislikes\",\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"new_avg_likes_to_dislikes\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"((avg_likes_to_dislikes* count_vid) + (old_avg_likes_to_dislikes * old_count_vid)) / (old_count_vid + count_vid)\"]}],\"Path\":\"s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1694124951274\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1694124949132\"],\"Name\":\"new time after publish\",\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"new_time_after_publish\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"((avg_time_after_publish * count_vid) + (old_avg_time_after_publish  * old_count_vid)) / (old_count_vid + count_vid)\"]}],\"Path\":\"s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1684182166632\":{\"Aggregate\":{\"Aggs\":[{\"AggFunc\":\"avg\",\"Column\":[\"view_count\"]},{\"AggFunc\":\"count\",\"Column\":[\"video_id\"]},{\"AggFunc\":\"avg\",\"Column\":[\"timediffinday\"]},{\"AggFunc\":\"avg\",\"Column\":[\"likestodislikes\"]},{\"AggFunc\":\"avg\",\"Column\":[\"reactionstoviews\"]}],\"Groups\":[[\"categoryid\"]],\"Inputs\":[\"node-1684782270604\"],\"Name\":\"Aggregate\"}},\"node-1694268573672\":{\"S3CatalogTarget\":{\"Database\":\"test\",\"Inputs\":[\"node-1694126570672\"],\"Name\":\"AWS Glue Data Catalog\",\"PartitionKeys\":[],\"SchemaChangePolicy\":{\"EnableUpdateCatalog\":false},\"Table\":\"youtubekr\"}},\"node-1684776994581\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1694119643809\"],\"Name\":\"Added time difference since published to trending\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"video_id\",\"Type\":\"string\"},{\"Name\":\"title\",\"Type\":\"string\"},{\"Name\":\"publishedat\",\"Type\":\"timestamp\"},{\"Name\":\"channelid\",\"Type\":\"string\"},{\"Name\":\"channeltitle\",\"Type\":\"string\"},{\"Name\":\"categoryid\",\"Type\":\"string\"},{\"Name\":\"trending_date\",\"Type\":\"timestamp\"},{\"Name\":\"tags\",\"Type\":\"string\"},{\"Name\":\"view_count\",\"Type\":\"bigint\"},{\"Name\":\"likes\",\"Type\":\"bigint\"},{\"Name\":\"dislikes\",\"Type\":\"bigint\"},{\"Name\":\"comment_count\",\"Type\":\"bigint\"},{\"Name\":\"thumbnail_link\",\"Type\":\"string\"},{\"Name\":\"comments_disabled\",\"Type\":\"string\"},{\"Name\":\"ratings_disabled\",\"Type\":\"string\"},{\"Name\":\"description\",\"Type\":\"string\"},{\"Name\":\"isnewontrending\",\"Type\":\"int\"},{\"Name\":\"timediffinday\",\"Type\":\"int\"}]}],\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"timeDiffInDay\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"dateDiff(trending_date, publishedAt)\"]}],\"Path\":\"s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1684780765731\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1684776994581\"],\"Name\":\"reactions\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"video_id\",\"Type\":\"string\"},{\"Name\":\"title\",\"Type\":\"string\"},{\"Name\":\"publishedat\",\"Type\":\"timestamp\"},{\"Name\":\"channelid\",\"Type\":\"string\"},{\"Name\":\"channeltitle\",\"Type\":\"string\"},{\"Name\":\"categoryid\",\"Type\":\"string\"},{\"Name\":\"trending_date\",\"Type\":\"timestamp\"},{\"Name\":\"tags\",\"Type\":\"string\"},{\"Name\":\"view_count\",\"Type\":\"bigint\"},{\"Name\":\"likes\",\"Type\":\"bigint\"},{\"Name\":\"dislikes\",\"Type\":\"bigint\"},{\"Name\":\"comment_count\",\"Type\":\"bigint\"},{\"Name\":\"thumbnail_link\",\"Type\":\"string\"},{\"Name\":\"comments_disabled\",\"Type\":\"string\"},{\"Name\":\"ratings_disabled\",\"Type\":\"string\"},{\"Name\":\"description\",\"Type\":\"string\"},{\"Name\":\"isnewontrending\",\"Type\":\"int\"},{\"Name\":\"timediffinday\",\"Type\":\"int\"},{\"Name\":\"reactions\",\"Type\":\"bigint\"}]}],\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"reactions\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"likes + dislikes\"]}],\"Path\":\"s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1694119643809\":{\"Filter\":{\"Filters\":[{\"Negated\":false,\"Operation\":\"LTE\",\"Values\":[{\"Type\":\"COLUMNEXTRACTED\",\"Value\":[\"isnewontrending\"]},{\"Type\":\"CONSTANT\",\"Value\":[\"0\"]}]}],\"Inputs\":[\"node-1694118304154\"],\"LogicalOperator\":\"AND\",\"Name\":\"Filter\"}},\"node-1694124460324\":{\"Join\":{\"Columns\":[{\"From\":\"node-1684790208665\",\"Keys\":[[\"category_title\"]]},{\"From\":\"node-1694124578742\",\"Keys\":[[\"old_category_title\"]]}],\"Inputs\":[\"node-1684790208665\",\"node-1694124578742\"],\"JoinType\":\"equijoin\",\"Name\":\"JoinFinal\"}},\"node-1694124953207\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1694124952351\"],\"Name\":\"new avg reactions to views\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"avg_view_count\",\"Type\":\"double\"},{\"Name\":\"avg_reactions_to_views\",\"Type\":\"double\"},{\"Name\":\"avg_likes_to_dislikes\",\"Type\":\"double\"},{\"Name\":\"old_avg_view_count\",\"Type\":\"double\"},{\"Name\":\"avg_time_after_publish\",\"Type\":\"double\"},{\"Name\":\"category_title\",\"Type\":\"string\"},{\"Name\":\"old_avg_reactions_to_views\",\"Type\":\"double\"},{\"Name\":\"old_category_title\",\"Type\":\"string\"},{\"Name\":\"old_avg_likes_to_dislikes\",\"Type\":\"double\"},{\"Name\":\"old_count_vid\",\"Type\":\"int\"},{\"Name\":\"count_vid\",\"Type\":\"bigint\"},{\"Name\":\"old_avg_time_after_publish\",\"Type\":\"double\"},{\"Name\":\"new_vid_count\",\"Type\":\"bigint\"},{\"Name\":\"new_view_count\",\"Type\":\"double\"},{\"Name\":\"new_time_after_publish\",\"Type\":\"double\"},{\"Name\":\"new_avg_likes_to_dislikes\",\"Type\":\"double\"},{\"Name\":\"new_avg_reactions_to_views\",\"Type\":\"double\"}]}],\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"new_avg_reactions_to_views\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"((avg_reactions_to_views * count_vid) + (old_avg_reactions_to_views * old_count_vid)) / (old_count_vid + count_vid)\"]}],\"Path\":\"s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1694124578742\":{\"ApplyMapping\":{\"Inputs\":[\"node-1694124319103\"],\"Mapping\":[{\"Dropped\":false,\"FromPath\":[\"avg_view_count\"],\"FromType\":\"double\",\"ToKey\":\"old_avg_view_count\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"count_vid\"],\"FromType\":\"long\",\"ToKey\":\"old_count_vid\",\"ToType\":\"long\"},{\"Dropped\":false,\"FromPath\":[\"avg_time_after_publish\"],\"FromType\":\"double\",\"ToKey\":\"old_avg_time_after_publish\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"avg_likes_to_dislikes\"],\"FromType\":\"double\",\"ToKey\":\"old_avg_likes_to_dislikes\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"avg_reactions_to_views\"],\"FromType\":\"double\",\"ToKey\":\"old_avg_reactions_to_views\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"category_title\"],\"FromType\":\"string\",\"ToKey\":\"old_category_title\",\"ToType\":\"string\"}],\"Name\":\"Renamed keys for Join\"}},\"node-1694124949132\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1694124923877\"],\"Name\":\"new view count\",\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"new_view_count\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"((avg_view_count * count_vid) + (old_avg_view_count * old_count_vid)) / (old_count_vid + count_vid)\"]}],\"Path\":\"s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1684782087635\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1684780765731\"],\"Name\":\"reactionsToViewsRatio\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"video_id\",\"Type\":\"string\"},{\"Name\":\"title\",\"Type\":\"string\"},{\"Name\":\"publishedat\",\"Type\":\"timestamp\"},{\"Name\":\"channelid\",\"Type\":\"string\"},{\"Name\":\"channeltitle\",\"Type\":\"string\"},{\"Name\":\"categoryid\",\"Type\":\"string\"},{\"Name\":\"trending_date\",\"Type\":\"timestamp\"},{\"Name\":\"tags\",\"Type\":\"string\"},{\"Name\":\"view_count\",\"Type\":\"bigint\"},{\"Name\":\"likes\",\"Type\":\"bigint\"},{\"Name\":\"dislikes\",\"Type\":\"bigint\"},{\"Name\":\"comment_count\",\"Type\":\"bigint\"},{\"Name\":\"thumbnail_link\",\"Type\":\"string\"},{\"Name\":\"comments_disabled\",\"Type\":\"string\"},{\"Name\":\"ratings_disabled\",\"Type\":\"string\"},{\"Name\":\"description\",\"Type\":\"string\"},{\"Name\":\"isnewontrending\",\"Type\":\"int\"},{\"Name\":\"timediffinday\",\"Type\":\"int\"},{\"Name\":\"reactions\",\"Type\":\"bigint\"},{\"Name\":\"reactionstoviews\",\"Type\":\"double\"}]}],\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"reactionsToViews\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"reactions * 100 /view_count\"]}],\"Path\":\"s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1684790208665\":{\"ApplyMapping\":{\"Inputs\":[\"node-1693859065372\"],\"Mapping\":[{\"Dropped\":true,\"FromPath\":[\"categoryid\"],\"FromType\":\"string\",\"ToKey\":\"categoryid\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"avg(view_count)\"],\"FromType\":\"double\",\"ToKey\":\"avg_view_count\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"count(video_id)\"],\"FromType\":\"long\",\"ToKey\":\"count_vid\",\"ToType\":\"long\"},{\"Dropped\":false,\"FromPath\":[\"avg(timediffinday)\"],\"FromType\":\"double\",\"ToKey\":\"avg_time_after_publish\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"avg(likestodislikes)\"],\"FromType\":\"double\",\"ToKey\":\"avg_likes_to_dislikes\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"avg(reactionstoviews)\"],\"FromType\":\"double\",\"ToKey\":\"avg_reactions_to_views\",\"ToType\":\"double\"},{\"Dropped\":true,\"FromPath\":[\"kind\"],\"FromType\":\"string\",\"ToKey\":\"kind\",\"ToType\":\"string\"},{\"Dropped\":true,\"FromPath\":[\"etag\"],\"FromType\":\"string\",\"ToKey\":\"etag\",\"ToType\":\"string\"},{\"Dropped\":true,\"FromPath\":[\"id\"],\"FromType\":\"string\",\"ToKey\":\"id\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"snippet.title\"],\"FromType\":\"string\",\"ToKey\":\"category_title\",\"ToType\":\"string\"},{\"Dropped\":true,\"FromPath\":[\"snippet.assignable\"],\"FromType\":\"boolean\",\"ToKey\":\"snippet.assignable\",\"ToType\":\"boolean\"},{\"Dropped\":true,\"FromPath\":[\"snippet.channelid\"],\"FromType\":\"string\",\"ToKey\":\"snippet.channelid\",\"ToType\":\"string\"}],\"Name\":\"Change Schema\"}},\"node-1684782270604\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1684782087635\"],\"Name\":\"likesToDislikes\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"video_id\",\"Type\":\"string\"},{\"Name\":\"title\",\"Type\":\"string\"},{\"Name\":\"publishedat\",\"Type\":\"timestamp\"},{\"Name\":\"channelid\",\"Type\":\"string\"},{\"Name\":\"channeltitle\",\"Type\":\"string\"},{\"Name\":\"categoryid\",\"Type\":\"string\"},{\"Name\":\"trending_date\",\"Type\":\"timestamp\"},{\"Name\":\"tags\",\"Type\":\"string\"},{\"Name\":\"view_count\",\"Type\":\"bigint\"},{\"Name\":\"likes\",\"Type\":\"bigint\"},{\"Name\":\"dislikes\",\"Type\":\"bigint\"},{\"Name\":\"comment_count\",\"Type\":\"bigint\"},{\"Name\":\"thumbnail_link\",\"Type\":\"string\"},{\"Name\":\"comments_disabled\",\"Type\":\"string\"},{\"Name\":\"ratings_disabled\",\"Type\":\"string\"},{\"Name\":\"description\",\"Type\":\"string\"},{\"Name\":\"isnewontrending\",\"Type\":\"int\"},{\"Name\":\"timediffinday\",\"Type\":\"int\"},{\"Name\":\"reactions\",\"Type\":\"bigint\"},{\"Name\":\"reactionstoviews\",\"Type\":\"double\"},{\"Name\":\"likestodislikes\",\"Type\":\"double\"}]}],\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"likesToDislikes\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"likes * 100 / reactions\"]}],\"Path\":\"s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1694124319103\":{\"S3CatalogSource\":{\"AdditionalOptions\":{},\"Database\":\"test\",\"Name\":\"OldData\",\"PartitionPredicate\":\"\",\"Table\":\"youtubekr\"}},\"node-1694118304154\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1693863807956\"],\"Name\":\"datediff\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"video_id\",\"Type\":\"string\"},{\"Name\":\"title\",\"Type\":\"string\"},{\"Name\":\"publishedat\",\"Type\":\"timestamp\"},{\"Name\":\"channelid\",\"Type\":\"string\"},{\"Name\":\"channeltitle\",\"Type\":\"string\"},{\"Name\":\"categoryid\",\"Type\":\"string\"},{\"Name\":\"trending_date\",\"Type\":\"timestamp\"},{\"Name\":\"tags\",\"Type\":\"string\"},{\"Name\":\"view_count\",\"Type\":\"bigint\"},{\"Name\":\"likes\",\"Type\":\"bigint\"},{\"Name\":\"dislikes\",\"Type\":\"bigint\"},{\"Name\":\"comment_count\",\"Type\":\"bigint\"},{\"Name\":\"thumbnail_link\",\"Type\":\"string\"},{\"Name\":\"comments_disabled\",\"Type\":\"string\"},{\"Name\":\"ratings_disabled\",\"Type\":\"string\"},{\"Name\":\"description\",\"Type\":\"string\"},{\"Name\":\"isnewontrending\",\"Type\":\"int\"}]}],\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"isnewontrending\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"DATEDIFF(trending_date,current_date())\"]}],\"Path\":\"s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1694124923877\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1694124460324\"],\"Name\":\"new vid count\",\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"new_vid_count\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"old_count_vid + count_vid\"]}],\"Path\":\"s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1694268052008\":{\"CustomCode\":{\"ClassName\":\"MyTransform\",\"Code\":\"glueContext.purge_s3_path(\\\"s3://outputyoutubebucket/awsresult/KR/\\\",options={\\\"retentionPeriod\\\": 0}, transformation_ctx=\\\"\\\")\\nreturn dfc\\n\",\"Inputs\":[\"node-1694124460324\"],\"Name\":\"Remove Old Files\"}},\"node-1684181625956\":{\"S3CsvSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":true,\"SamplePath\":\"s3://inputyoutubebucket/input/BR_youtube_trending_data.csv\"},\"Escaper\":\"\",\"Exclusions\":[],\"Name\":\"MX data\",\"OptimizePerformance\":false,\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"video_id\",\"Type\":\"string\"},{\"Name\":\"title\",\"Type\":\"string\"},{\"Name\":\"publishedAt\",\"Type\":\"string\"},{\"Name\":\"channelId\",\"Type\":\"string\"},{\"Name\":\"channelTitle\",\"Type\":\"string\"},{\"Name\":\"categoryId\",\"Type\":\"string\"},{\"Name\":\"trending_date\",\"Type\":\"string\"},{\"Name\":\"tags\",\"Type\":\"string\"},{\"Name\":\"view_count\",\"Type\":\"string\"},{\"Name\":\"likes\",\"Type\":\"string\"},{\"Name\":\"dislikes\",\"Type\":\"string\"},{\"Name\":\"comment_count\",\"Type\":\"string\"},{\"Name\":\"thumbnail_link\",\"Type\":\"string\"},{\"Name\":\"comments_disabled\",\"Type\":\"string\"},{\"Name\":\"ratings_disabled\",\"Type\":\"string\"},{\"Name\":\"description\",\"Type\":\"string\"}]}],\"Paths\":[\"s3://inputyoutubebucket/input/KR_youtube_trending_data.csv\"],\"QuoteChar\":\"quote\",\"Recurse\":true,\"Separator\":\"comma\",\"WithHeader\":true}},\"node-1684181651659\":{\"S3JsonSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://inputyoutubebucket/input/KR_category_id.json\"},\"Exclusions\":[],\"JsonPath\":\"$.items[*]\",\"Multiline\":false,\"Name\":\"KR category\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"kind\",\"Type\":\"string\"},{\"Name\":\"etag\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"string\"},{\"Name\":\"snippet\",\"Type\":\"struct<title:string,assignable:boolean,channelId:string>\"}]}],\"Paths\":[\"s3://inputyoutubebucket/input/KR_category_id.json\"],\"Recurse\":true}},\"node-1694126570672\":{\"ApplyMapping\":{\"Inputs\":[\"node-1694124953207\"],\"Mapping\":[{\"Dropped\":false,\"FromPath\":[\"new_view_count\"],\"FromType\":\"double\",\"ToKey\":\"avg_view_count\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"new_vid_count\"],\"FromType\":\"bigint\",\"ToKey\":\"count_vid\",\"ToType\":\"long\"},{\"Dropped\":false,\"FromPath\":[\"new_time_after_publish\"],\"FromType\":\"double\",\"ToKey\":\"avg_time_after_publish\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"new_avg_likes_to_dislikes\"],\"FromType\":\"double\",\"ToKey\":\"avg_likes_to_dislikes\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"new_avg_reactions_to_views\"],\"FromType\":\"double\",\"ToKey\":\"avg_reactions_to_views\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"category_title\"],\"FromType\":\"string\",\"ToKey\":\"category_title\",\"ToType\":\"string\"}],\"Name\":\"final schema\"}},\"node-1693863807956\":{\"ApplyMapping\":{\"Inputs\":[\"node-1684181625956\"],\"Mapping\":[{\"Dropped\":false,\"FromPath\":[\"video_id\"],\"FromType\":\"string\",\"ToKey\":\"video_id\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"title\"],\"FromType\":\"string\",\"ToKey\":\"title\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"publishedAt\"],\"FromType\":\"string\",\"ToKey\":\"publishedAt\",\"ToType\":\"timestamp\"},{\"Dropped\":false,\"FromPath\":[\"channelId\"],\"FromType\":\"string\",\"ToKey\":\"channelId\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"channelTitle\"],\"FromType\":\"string\",\"ToKey\":\"channelTitle\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"categoryId\"],\"FromType\":\"string\",\"ToKey\":\"categoryId\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"trending_date\"],\"FromType\":\"string\",\"ToKey\":\"trending_date\",\"ToType\":\"timestamp\"},{\"Dropped\":false,\"FromPath\":[\"tags\"],\"FromType\":\"string\",\"ToKey\":\"tags\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"view_count\"],\"FromType\":\"string\",\"ToKey\":\"view_count\",\"ToType\":\"bigint\"},{\"Dropped\":false,\"FromPath\":[\"likes\"],\"FromType\":\"string\",\"ToKey\":\"likes\",\"ToType\":\"bigint\"},{\"Dropped\":false,\"FromPath\":[\"dislikes\"],\"FromType\":\"string\",\"ToKey\":\"dislikes\",\"ToType\":\"bigint\"},{\"Dropped\":false,\"FromPath\":[\"comment_count\"],\"FromType\":\"string\",\"ToKey\":\"comment_count\",\"ToType\":\"bigint\"},{\"Dropped\":false,\"FromPath\":[\"thumbnail_link\"],\"FromType\":\"string\",\"ToKey\":\"thumbnail_link\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"comments_disabled\"],\"FromType\":\"string\",\"ToKey\":\"comments_disabled\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"ratings_disabled\"],\"FromType\":\"string\",\"ToKey\":\"ratings_disabled\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"description\"],\"FromType\":\"string\",\"ToKey\":\"description\",\"ToType\":\"string\"}],\"Name\":\"DataSchema\"}},\"node-1693859065372\":{\"Join\":{\"Columns\":[{\"From\":\"node-1684182166632\",\"Keys\":[[\"categoryid\"]]},{\"From\":\"node-1689531333926\",\"Keys\":[[\"id\"]]}],\"Inputs\":[\"node-1684182166632\",\"node-1689531333926\"],\"JoinType\":\"equijoin\",\"Name\":\"Join\"}},\"node-1689531333926\":{\"DynamicTransform\":{\"FunctionName\":\"gs_flatten\",\"Inputs\":[\"node-1684181651659\"],\"Name\":\"Flatten\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"kind\",\"Type\":\"string\"},{\"Name\":\"etag\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"string\"},{\"Name\":\"snippet.title\",\"Type\":\"string\"},{\"Name\":\"snippet.assignable\",\"Type\":\"boolean\"},{\"Name\":\"snippet.channelid\",\"Type\":\"string\"}]}],\"Parameters\":[],\"Path\":\"s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_flatten.py\",\"TransformName\":\"gs_flatten\",\"Version\":\"1.0.0\"}}}",
  "sourceControlDetails" : {
    "provider" : "GITHUB",
    "repository" : "AmazonGlueETL",
    "branch" : "master",
    "folder" : "youtube"
  }
}