{
  "name" : "youtube-FR-initial",
  "description" : "",
  "role" : "arn:aws:iam::057994567553:role/glueRole",
  "executionProperty" : {
    "maxConcurrentRuns" : 1
  },
  "command" : {
    "name" : "glueetl",
    "scriptLocation" : "s3://aws-glue-assets-057994567553-eu-north-1/scripts/youtube-FR-initial.py",
    "pythonVersion" : "3"
  },
  "defaultArguments" : {
    "--enable-metrics" : "true",
    "--enable-spark-ui" : "true",
    "--extra-py-files" : "s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_common.py,s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_derived.py,s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_flatten.py",
    "--spark-event-logs-path" : "s3://aws-glue-assets-057994567553-eu-north-1/sparkHistoryLogs/",
    "--enable-job-insights" : "true",
    "--enable-glue-datacatalog" : "true",
    "--enable-continuous-cloudwatch-log" : "true",
    "--job-bookmark-option" : "job-bookmark-disable",
    "--job-language" : "python",
    "--TempDir" : "s3://aws-glue-assets-057994567553-eu-north-1/temporary/"
  },
  "maxRetries" : 0,
  "allocatedCapacity" : 10,
  "timeout" : 2880,
  "maxCapacity" : 10.0,
  "glueVersion" : "3.0",
  "numberOfWorkers" : 10,
  "workerType" : "G.1X",
  "codeGenConfigurationNodes" : "{\"node-1684182166632\":{\"Aggregate\":{\"Aggs\":[{\"AggFunc\":\"avg\",\"Column\":[\"view_count\"]},{\"AggFunc\":\"count\",\"Column\":[\"video_id\"]},{\"AggFunc\":\"avg\",\"Column\":[\"timediffinday\"]},{\"AggFunc\":\"avg\",\"Column\":[\"likestodislikes\"]},{\"AggFunc\":\"avg\",\"Column\":[\"reactionstoviews\"]}],\"Groups\":[[\"categoryid\"]],\"Inputs\":[\"node-1684782270604\"],\"Name\":\"Aggregate\"}},\"node-1684776994581\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1693863807956\"],\"Name\":\"Added time difference since published to trending\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"video_id\",\"Type\":\"string\"},{\"Name\":\"title\",\"Type\":\"string\"},{\"Name\":\"publishedat\",\"Type\":\"timestamp\"},{\"Name\":\"channelid\",\"Type\":\"string\"},{\"Name\":\"channeltitle\",\"Type\":\"string\"},{\"Name\":\"categoryid\",\"Type\":\"string\"},{\"Name\":\"trending_date\",\"Type\":\"timestamp\"},{\"Name\":\"tags\",\"Type\":\"string\"},{\"Name\":\"view_count\",\"Type\":\"string\"},{\"Name\":\"likes\",\"Type\":\"string\"},{\"Name\":\"dislikes\",\"Type\":\"string\"},{\"Name\":\"comment_count\",\"Type\":\"string\"},{\"Name\":\"thumbnail_link\",\"Type\":\"string\"},{\"Name\":\"comments_disabled\",\"Type\":\"string\"},{\"Name\":\"ratings_disabled\",\"Type\":\"string\"},{\"Name\":\"description\",\"Type\":\"string\"},{\"Name\":\"timediffinday\",\"Type\":\"int\"}]}],\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"timeDiffInDay\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"dateDiff(trending_date, publishedAt)\"]}],\"Path\":\"s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1684181625956\":{\"S3CsvSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":true,\"SamplePath\":\"s3://inputyoutubebucket/input/BR_youtube_trending_data.csv\"},\"Escaper\":\"\",\"Exclusions\":[],\"Name\":\"FR data\",\"OptimizePerformance\":false,\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"video_id\",\"Type\":\"string\"},{\"Name\":\"title\",\"Type\":\"string\"},{\"Name\":\"publishedAt\",\"Type\":\"string\"},{\"Name\":\"channelId\",\"Type\":\"string\"},{\"Name\":\"channelTitle\",\"Type\":\"string\"},{\"Name\":\"categoryId\",\"Type\":\"string\"},{\"Name\":\"trending_date\",\"Type\":\"string\"},{\"Name\":\"tags\",\"Type\":\"string\"},{\"Name\":\"view_count\",\"Type\":\"string\"},{\"Name\":\"likes\",\"Type\":\"string\"},{\"Name\":\"dislikes\",\"Type\":\"string\"},{\"Name\":\"comment_count\",\"Type\":\"string\"},{\"Name\":\"thumbnail_link\",\"Type\":\"string\"},{\"Name\":\"comments_disabled\",\"Type\":\"string\"},{\"Name\":\"ratings_disabled\",\"Type\":\"string\"},{\"Name\":\"description\",\"Type\":\"string\"}]}],\"Paths\":[\"s3://inputyoutubebucket/input/FR_youtube_trending_data.csv\"],\"QuoteChar\":\"quote\",\"Recurse\":true,\"Separator\":\"comma\",\"WithHeader\":true}},\"node-1684181651659\":{\"S3JsonSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://inputyoutubebucket/input/FR_category_id.json\"},\"Exclusions\":[],\"JsonPath\":\"$.items[*]\",\"Multiline\":false,\"Name\":\"FR category\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"kind\",\"Type\":\"string\"},{\"Name\":\"etag\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"string\"},{\"Name\":\"snippet\",\"Type\":\"struct<title:string,assignable:boolean,channelId:string>\"}]}],\"Paths\":[\"s3://inputyoutubebucket/input/FR_category_id.json\"],\"Recurse\":true}},\"node-1684780765731\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1684776994581\"],\"Name\":\"reactions\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"snippet\",\"Type\":\"struct<title:string,assignable:boolean,channelid:string>\"},{\"Name\":\"categoryid\",\"Type\":\"string\"},{\"Name\":\"ratings_disabled\",\"Type\":\"string\"},{\"Name\":\"comments_disabled\",\"Type\":\"string\"},{\"Name\":\"channeltitle\",\"Type\":\"string\"},{\"Name\":\"trending_date\",\"Type\":\"timestamp\"},{\"Name\":\"country\",\"Type\":\"string\"},{\"Name\":\"etag\",\"Type\":\"string\"},{\"Name\":\"video_id\",\"Type\":\"string\"},{\"Name\":\"thumbnail_link\",\"Type\":\"string\"},{\"Name\":\"kind\",\"Type\":\"string\"},{\"Name\":\"comment_count\",\"Type\":\"string\"},{\"Name\":\"likes\",\"Type\":\"string\"},{\"Name\":\"description\",\"Type\":\"string\"},{\"Name\":\"dislikes\",\"Type\":\"string\"},{\"Name\":\"publishedat\",\"Type\":\"timestamp\"},{\"Name\":\"title\",\"Type\":\"string\"},{\"Name\":\"tags\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"string\"},{\"Name\":\"channelid\",\"Type\":\"string\"},{\"Name\":\"view_count\",\"Type\":\"string\"},{\"Name\":\"timediffinday\",\"Type\":\"int\"},{\"Name\":\"reactions\",\"Type\":\"double\"}]}],\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"reactions\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"likes + dislikes\"]}],\"Path\":\"s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1693863807956\":{\"ApplyMapping\":{\"Inputs\":[\"node-1684181625956\"],\"Mapping\":[{\"Dropped\":false,\"FromPath\":[\"video_id\"],\"FromType\":\"string\",\"ToKey\":\"video_id\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"title\"],\"FromType\":\"string\",\"ToKey\":\"title\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"publishedAt\"],\"FromType\":\"string\",\"ToKey\":\"publishedAt\",\"ToType\":\"timestamp\"},{\"Dropped\":false,\"FromPath\":[\"channelId\"],\"FromType\":\"string\",\"ToKey\":\"channelId\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"channelTitle\"],\"FromType\":\"string\",\"ToKey\":\"channelTitle\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"categoryId\"],\"FromType\":\"string\",\"ToKey\":\"categoryId\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"trending_date\"],\"FromType\":\"string\",\"ToKey\":\"trending_date\",\"ToType\":\"timestamp\"},{\"Dropped\":false,\"FromPath\":[\"tags\"],\"FromType\":\"string\",\"ToKey\":\"tags\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"view_count\"],\"FromType\":\"string\",\"ToKey\":\"view_count\",\"ToType\":\"bigint\"},{\"Dropped\":false,\"FromPath\":[\"likes\"],\"FromType\":\"string\",\"ToKey\":\"likes\",\"ToType\":\"bigint\"},{\"Dropped\":false,\"FromPath\":[\"dislikes\"],\"FromType\":\"string\",\"ToKey\":\"dislikes\",\"ToType\":\"bigint\"},{\"Dropped\":false,\"FromPath\":[\"comment_count\"],\"FromType\":\"string\",\"ToKey\":\"comment_count\",\"ToType\":\"bigint\"},{\"Dropped\":false,\"FromPath\":[\"thumbnail_link\"],\"FromType\":\"string\",\"ToKey\":\"thumbnail_link\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"comments_disabled\"],\"FromType\":\"string\",\"ToKey\":\"comments_disabled\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"ratings_disabled\"],\"FromType\":\"string\",\"ToKey\":\"ratings_disabled\",\"ToType\":\"string\"},{\"Dropped\":false,\"FromPath\":[\"description\"],\"FromType\":\"string\",\"ToKey\":\"description\",\"ToType\":\"string\"}],\"Name\":\"GBDataSchema\"}},\"node-1693859065372\":{\"Join\":{\"Columns\":[{\"From\":\"node-1684182166632\",\"Keys\":[[\"categoryid\"]]},{\"From\":\"node-1689531333926\",\"Keys\":[[\"id\"]]}],\"Inputs\":[\"node-1684182166632\",\"node-1689531333926\"],\"JoinType\":\"equijoin\",\"Name\":\"Join\"}},\"node-1684782087635\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1684780765731\"],\"Name\":\"reactionsToViewsRatio\",\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"reactionsToViews\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"reactions * 100 /view_count\"]}],\"Path\":\"s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1684790208665\":{\"ApplyMapping\":{\"Inputs\":[\"node-1693859065372\"],\"Mapping\":[{\"Dropped\":false,\"FromPath\":[\"avg(view_count)\"],\"FromType\":\"double\",\"ToKey\":\"avg_view_count\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"count(video_id)\"],\"FromType\":\"long\",\"ToKey\":\"count_vid\",\"ToType\":\"long\"},{\"Dropped\":false,\"FromPath\":[\"avg(timediffinday)\"],\"FromType\":\"double\",\"ToKey\":\"avg_time_after_publish\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"avg(likestodislikes)\"],\"FromType\":\"double\",\"ToKey\":\"avg_likes_to_dislikes\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"avg(reactionstoviews)\"],\"FromType\":\"double\",\"ToKey\":\"avg_reactions_to_views\",\"ToType\":\"double\"},{\"Dropped\":false,\"FromPath\":[\"snippet.title\"],\"FromType\":\"string\",\"ToKey\":\"category_title\",\"ToType\":\"string\"}],\"Name\":\"Change Schema\"}},\"node-1694452779635\":{\"S3CatalogTarget\":{\"Database\":\"test\",\"Inputs\":[\"node-1684790208665\"],\"Name\":\"AWS Glue Data Catalog\",\"PartitionKeys\":[],\"SchemaChangePolicy\":{\"EnableUpdateCatalog\":true,\"UpdateBehavior\":\"UPDATE_IN_DATABASE\"},\"Table\":\"youtubefr\"}},\"node-1684782270604\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1684782087635\"],\"Name\":\"likesToDislikes\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"snippet.channelid\",\"Type\":\"string\"},{\"Name\":\"ratings_disabled\",\"Type\":\"string\"},{\"Name\":\"snippet.title\",\"Type\":\"string\"},{\"Name\":\"comments_disabled\",\"Type\":\"string\"},{\"Name\":\"trending_date\",\"Type\":\"timestamp\"},{\"Name\":\"etag\",\"Type\":\"string\"},{\"Name\":\"country\",\"Type\":\"string\"},{\"Name\":\"video_id\",\"Type\":\"string\"},{\"Name\":\"channelid\",\"Type\":\"string\"},{\"Name\":\"thumbnail_link\",\"Type\":\"string\"},{\"Name\":\"kind\",\"Type\":\"string\"},{\"Name\":\"likes\",\"Type\":\"bigint\"},{\"Name\":\"comment_count\",\"Type\":\"bigint\"},{\"Name\":\"categoryid\",\"Type\":\"string\"},{\"Name\":\"description\",\"Type\":\"string\"},{\"Name\":\"dislikes\",\"Type\":\"bigint\"},{\"Name\":\"snippet.assignable\",\"Type\":\"boolean\"},{\"Name\":\"channeltitle\",\"Type\":\"string\"},{\"Name\":\"title\",\"Type\":\"string\"},{\"Name\":\"publishedat\",\"Type\":\"timestamp\"},{\"Name\":\"tags\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"string\"},{\"Name\":\"view_count\",\"Type\":\"bigint\"},{\"Name\":\"timediffinday\",\"Type\":\"int\"},{\"Name\":\"reactions\",\"Type\":\"bigint\"},{\"Name\":\"reactionstoviews\",\"Type\":\"double\"},{\"Name\":\"likestodislikes\",\"Type\":\"double\"}]}],\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"likesToDislikes\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"likes * 100 / reactions\"]}],\"Path\":\"s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1689531333926\":{\"DynamicTransform\":{\"FunctionName\":\"gs_flatten\",\"Inputs\":[\"node-1684181651659\"],\"Name\":\"Flatten\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"kind\",\"Type\":\"string\"},{\"Name\":\"etag\",\"Type\":\"string\"},{\"Name\":\"id\",\"Type\":\"string\"},{\"Name\":\"snippet.title\",\"Type\":\"string\"},{\"Name\":\"snippet.assignable\",\"Type\":\"boolean\"},{\"Name\":\"snippet.channelid\",\"Type\":\"string\"}]}],\"Parameters\":[],\"Path\":\"s3://aws-glue-studio-transforms-312557305497-prod-eu-north-1/gs_flatten.py\",\"TransformName\":\"gs_flatten\",\"Version\":\"1.0.0\"}}}",
  "sourceControlDetails" : {
    "provider" : "GITHUB",
    "repository" : "AmazonGlueETL",
    "branch" : "master",
    "folder" : "youtube"
  }
}